
Code "D-Pad In 2D Sections" by "DevDede" and "Placed5th"
//

    #lib "Player"
    #lib "BlackboardStatus"
    #lib "HMM"
	#lib "INI"
    #lib "XInput"


    #load "System.Numerics.dll"

    using System.Collections.Generic;
    using System.Numerics;
    using System.Diagnostics;
    using System.Runtime.InteropServices;

    static bool IsConfigInitialised = false;
	static int DPadType = 0;
    static bool UseLeftTiltLeftJoystick = false; // set to true to enable left joystick
    static bool UseRightTiltLeftJoystick = false; // set to true to enable right joystick
    static bool UseDownTiltLeftJoystick = false; // set to true to enable south joystick

    #define PRINT(in_str) Console.WriteLine(in_str)
//
{

    

    var state = Player.State.GetCurrentStateID<Sonic.StateID>();

   

    if (Player.GetPlayerType() != Player.PlayerType.Sonic)
        return;


    if (!IsConfigInitialised)
    {
        var modsQuery = HMM.FindModsByName("Frontiers 2D D-Pad Support");

        if (modsQuery.Count == 1)
            {
            string modConfigIniPath = System.IO.Path.Combine(modsQuery[0].Path, "config.ini");
            var ini = INI.Read(modConfigIniPath);

            DPadType = INI.Parse<int>(ini["Main"]["DPadType"], DPadType );
            }

        IsConfigInitialised = true;
    }

    if(UseLeftTiltLeftJoystick == true) 
    {
        
         PRINT("DPAD LEFT BUTTON DOWN");
    } else {
        
    }

    if(UseRightTiltLeftJoystick == true) 
    {
        
        
        PRINT("DPAD RIGHT BUTTON DOWN"); // Writes 1 to the console.
    } else {

    }

    if(UseDownTiltLeftJoystick == true) 
    {

    }

    if (DPadType == 1)
    {
       if (XInput.IsButtonDown(XInput.Buttons.DPAD_UP))
       {

       }

       if (XInput.IsButtonDown(XInput.Buttons.DPAD_DOWN))
       {

       }

       if (XInput.IsButtonDown(XInput.Buttons.DPAD_RIGHT))
       {
            UseRightTiltLeftJoystick = true;
            
            
       } else {
            UseRightTiltLeftJoystick = false;
       }

       if (XInput.IsButtonDown(XInput.Buttons.DPAD_LEFT))
       {
            UseLeftTiltLeftJoystick = true;
            
       } else {
            UseLeftTiltLeftJoystick = false;
       }
    }
    
    
    //Classic Spindash Support DPAD
    if (DPadType == 2)
    {
         if (XInput.IsButtonDown(XInput.Buttons.DPAD_UP))
       {

       }

       if (XInput.IsButtonDown(XInput.Buttons.DPAD_DOWN))
       {

       }

       if (XInput.IsButtonDown(XInput.Buttons.DPAD_RIGHT))
       {
            UseRightTiltLeftJoystick = true;
       } else {
            UseRightTiltLeftJoystick = false;
       }

       if (XInput.IsButtonDown(XInput.Buttons.DPAD_LEFT))
       {
            UseLeftTiltLeftJoystick = true;
       } else {
            UseLeftTiltLeftJoystick = false;
       }
    }
}


